Способы послать ping (пингуй по-разному): даже во сне

- Ping mf.bmstu.ru
- Ping ww.msfu.ru
- Ping 62.122.196.3
- Ping 1048232963 (256^3 * 62 + 256^2 * 122 + 256 * 196 + 1 * 3)
- Ping 3e7ac403
- Ping 076.0172.0304.03 (16-й октеты)
- Ping 62.122.0xc403

IPv6 (1996) - создан на замену IPv4 (1984) со значительно большим количеством допустимых ip-адресов.

Для определения числа подсетей в сети необходимо знать число бит под адреса. Например, при отведенном числе 48 бит получаем число подсетей в сети = 2^80 или 2^(128-x), где x - число бит под адреса.

Адреса IPv4 имеют маску подсети, но вместо ввода типа 255.255.255.0 в IPv6 мы используем длину префикса. Ниже приведен пример префикса IPv6:
![[сэвм4-1.jpg | 300]]
2001:1234:5678:1234:0000:0000:0000:0000/64 является допустимым префиксом, но мы можем его сократить. Эта строка нулей может быть удалена и заменена на "::".
![[сэвм4-2.jpg | 300]]

Держатели ip-адресов уже могут содержать подсети.

Зарезервированные адреса:

- 0.0.0.0/32 (или ::0/128)
- Localhost (127.0.0.1 или ::1/128 )
- 169.254.0.0/16 (или fe80::ffff:MAC добавляется MAC адрес компа в Windows)
- fc00::/7 (старый формат mac)
- fec0::/8 (новый формат mac)
- 224.0.0.0/4 или ff00:: (полностью зарезервированный диапазон мультикаста)

Link-local адреса - адреса самонастройки. При отсутствии DHCP-сервера происходит самоназначение link-local адресов.

Передача IPv6 пакетов через IPv4 (тонеллирование IPv4) возможна, причем для этого существуют открытые, закрытые и проприетарные протоколы. Есть сервисы, предоставляющие услуги в сети на базе протоколов тонеллирования.

**Напоминание:** Сегментирование пакетов происходит на транспортном уровне.

ICMP_Ping max = MTU - IP header - ICMP header = 1500 - 20 - 8 = 1472
В один сегмент пакета может помещаться максимум 1472 байта.
При $ ping ya.ru -l 1473 один байт улетит в новый сегмент. 
EnterFrame = MTU + Frame header = 1500 + 14 байт
EnternetFrame = MTU + Preambula + Header + FCS/CRC 16 [+4 и 8 байт VLAN] = 1500 + 8 + 14 + 4 = 1526

![[сэвм4-3.png]]

**Маршрутизация** - процесс определения маршрута для передачи ip-пакета.

Виды маршрутизации:
- прямая (отправитель может отправлять кадры любому получателю в данной сети)
- косвенная (только если отправитель и получатель в разных подсетях и необходима передача через маршрутизаторы объединяющие эти сети)
- статическая
- динамическая

Протоколы маршрутизации: IDP, IPX, AppleTalk …

Routing protocols (протоколы маршрутизации) — это как раз те протоколы, о которых чуть ниже поговорим. При помощи этих протоколов, роутеры обмениваются маршрутной информацией и строят топологию.

Протоколы динамической маршрутизации делятся на 2 категории:
- IGP (interior gateway protocols) — внутренние протоколы маршрутизации (RIP, OSPF, EIGRP). Гости этого выпуска. 
- EGP (external gateway protocols) — внешние протоколы маршрутизации (на сегодня BGP).

Routed protocols (маршрутизируемые протоколы) — это как раз те протоколы, которые мы маршрутизируем. В данном случае — это IPv4, IPv6.

Почему IPV4 до сих пор жив, так потому, что разработчики провели множество оптимизаций… Франкенштейн от мира сетей.

![[сэвм4-4.png]]

В компьютерных классах используется NAT.

Коммутация IP-пакетов - технология, использующаяся для оптимизации работы маршрутизаторов при использовании неизменных или редко меняющихся маршрутов. Суть технологии - обработка IP-пакета без участия центрального процессора маршрутизатора.

Дальнейшие идеи развития - технологии протоколов IPNS - отказ от маршрутизации и обслуживание трафика абонента через коммутацию.

MPLS - многопротокольная коммутация по меткам / механизм в высокопроизводительной телекоммуникационной сети, осуществляющий передачу данных от одного узла сети к другому с помощью меток. MPLS является масштабируемым и независимым от каких-либо протоколов механизмом передачи данных.

Классификация алгоритмов маршрутизации:
- **Простая** - изначально применялась в сетях ARPANET / обеспечивается алгоритмами, типичные из которых:

	- Случайная (передача пакета в любом случайным образом выбранном направлении с последующим поиском получателя, кроме направления, откуда поступил сам пакет - маршрутизация неэффективна как по времени, так и по использованию ресурса сети);
	- Лавинная (передача всем пользователям сети кроме того, откуда поступил пакет - то есть все пользователи подсети получают пакет - маршрутизация гарантирует минимальное время доставки, однако неэффективная в плане использования ресурса сети - сильная перегрузка );
	- Априорная (передача пакета в направлении, выбранном на основе анализа поступающих пакетов ответа / определение узлов маршрута по TTL и сохранение маршрутов в таблице и последующий выбор оптимального - переход на другой маршрут осуществляется в зависимости от меньшего числа КОП'ов - более эффективна, чем предыдущие, но процесс определения маршрута занимает определенное время).

- **Фиксированная** - способ выбора направления по таблице маршрутизации в формате отправитель - получатель. На данный момент самая распространенная маршрутизация в локальных сетях.

- **Одномаршрутная**
- **Многомаршрутная**

- **Адаптивная** - способ определения маршрута с учетом того, что состояние сети может поменяться в любой момент. На основе протоколов маршрутизации может перестраивать маршрут к получателю при любом изменении.

- Локальная
- Распределенная
- Централизованная
- Гибридная

![[сэвм4-5.png]]

**Сетевой шлюз** - аппаратный маршрутизатор или программное обеспечение для сопряжения компьютерных сетей, использующих разные протоколы (например, локальной и глобальной).

Может объединять подсети с разными адресными пространствами, подсетями и т. д.

Пакеты сетевого уровня могут маршрутизироваться разными путями.

Через разных операторов сетей, разные маршрутизаторы, разные магистральные каналы. IP-пакеты могут приходить в пункт назначения разными путями и разном изначальном порядке. Регулирование порядка происходит на транспортном уровне в том же порядке, в котором пакеты были отправлены (работа протокола TCP).

**Routing protocols** (протоколы маршрутизации) — это как раз те протоколы, о которых чуть ниже поговорим. При помощи этих протоколов, роутеры обмениваются маршрутной информацией и строят топологию.

Применение протоколов маршрутизации позволяет автоматизировать работу по построению маршрутов и избежать множества ошибок. Они, конечно, потребляют большее число ресурсов, но это количество затрат вполне оправдано.

При всем этом протоколы маршрутизации могут передавать как полные списки переходов клиентов с одного маршрутизатора сети на другой, так и изменения в построенной сети. Протоколы маршрутизации могут попадать в разные ветки классификации.

$ route print - вывод таблицы маршрутизации
$ netstat -r - то же самое

Структура таблицы маршрутизации:

|   |   |   |   |   |
|---|---|---|---|---|
|Сетевой адрес|Маска|Адрес шлюза|Интерфейс|Метрика|

Выбор оптимального маршрута производится на основе расчета через побитовую операцию над маской и сопоставление результата с сетевым адресом, а так же учитывается наименьшая метрика.

NEXT: [[С ЭВМ - Лекция 5]]