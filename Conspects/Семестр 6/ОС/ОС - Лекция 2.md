**Процесс** - фактически сама программа в стадии выполнения.

- Асинхронная работа
- "Живая душа" процедуры
- "Концентрация средств управления" для выполняемой процедуры
- Нечто, представленное в виде блока управления процессом в системе.
- Объект, которому выделяется необходимая память

---
#### Процессорная машина (рассматриваем однопроцессорные)

Таких машин сегодня очень много — это различные микроконтроллеры

Основные принципы работы однопроцессорных машин легко масштабируются на многопроцессорные (многоядерные) машины.

Как только программа попадает в очередь, она становится процессом.

Для программы, вошедшей из очереди и готовой к выполнению необходимо действие процессора.

В определённый момент времени на процессоре может выполняться только один процесс.

Сегодня любая программа должна останавливаться для получения данных (переходит в режим блокировки).

Во время блокировки программы/процесса, процессор выполняет другие задачи и программы.

В случае, когда процессору не хватает места для выполнения важного процесса системы/пользователя, то процесс может быть приостановлен (остановлен с сохранением данных, для последующего выполнения).

#процесс

![[ОС2.1.png]]

#### Состояние «Готов»

- «Куча» — выборка случайного.
- Общая очередь — выборка первого.
- Приоритетная очередь — выборка первого из имеющих максимальный приоритет.
- Приоритетная очередь с накапливаемым приоритетом.

#### Приоритет

- просто целое число.
- В разных ОС максимальный приоритет может кодироваться как нулём, так и максимальным значением числа.

#### Организация состояния готовности

- *V1*: куча (heap) - все поступающие процессы "падают" в область памяти и лежат вперемешку / процессор выбирает процессы случайно.

- *V2*: очередь (queue) - все процессы, поступающие в систему, выстраиваются в порядке поступления / процессор выбирает процессы из головы очереди.

![[ОС2.2.png | 300]]

После выполнения, процесс поступает обратно в конец очереди.

![[ОС2.3.png | 300]]

Но бывают случаи, когда некоторые процессы требуют как можно более частого выполнения, из-за чего такая очередь бывает неэффективна.

- *V2.1*: очередь с приоритетом - процессы поступают в несколько различных очередей (при том если на входе процессу не указан приоритет, он принимает приоритет по умолчанию) в зависимости от системы самый высокий приоритет может быть как большим числом или нулем).
	- После приостановки процесс может быть перемещен в конец очереди с соответствующим ему (возможно, по-новому присвоенном) приоритетом.
	- Процессы в высшим приоритетом более часто получают доступ к системным ресурсам

![[ОС2.4.png | 300]] ![[ОС2.5.png | 340]]

К сожалению для процессов с низким приоритетом может быть такое, что они будут находиться в бесконечном ожидании из-за постоянного откладывания в пользу более высокоприоритетных процессов.

- V2.2: очередь с накапливаемым приоритетом - при обрабатывании процесс сбрасывается до первоначального / при отклонении процесса и переотправке в очередь приоритет увеличивается.

Для решения подобных проблем используют очереди с накапливаемым приоритетом, в этом случае всем приоритетам при каждом обращении планировщика к очереди и выборке оттуда процесса, всем остальным процессам в очередях увеличивается приоритет на определённое значение. тем самым приоритет с самым низким приоритетом, рано или поздно, получит своё процессоров время.

---
#### Очередь

- *Общая* — новые процессы поступают в конец очереди.
- *Приоритетная* — новые процессы поступают в конец участка очереди со своим приоритетом.
- *С накоплением приоритета* — новые процессы поступают в конец участка очереди со своим первоначальным приоритетом.

---
#### Состояние «Выполнение»

- На однопроцессорном (одноядерном) вычислителе — всегда в один момент времени только один процесс.
- На многопроцессорном (многоядерном) вычислителе — процессов не больше, чем процессоров (ядер).

---
#### Состояние «Блокировка»

- Могут быть разные причины блокировки.
- Возможна организация «очереди» ожидания по каждому типу блокировки.
- Внутри «очередей» процессы обычно не упорядочены.

В системах пакетной обработки процессы выполняются без особенных прерываний - окончание процесса после полного выполнения или полной блокировки.

Однако не все ресурсы можно изъять у процесса при приостановке, к таким ресурсам относятся оптические диски.

---
#### Приостановка процессов

- *Приостановка* — вынужденная мера при недостаточности ресурсов системы для продолжения работы процессов.
- В состоянии приостановки у процесса временно изымается часть предоставленных ему ресурсов.
- Далеко не каждый процесс можно приостановить, не нарушив ход его работы.

---
#### Контекст процесса

- Данные и состояние аппаратуры ЭВМ, которые необходимы для нормальной работы процесса.
- Контекст должен быть сохранён при освобождении процессора (переходе в состояние готовности, либо блокировки) и восстановлен при возвращении в состояние выполнения.
- Как минимум, должны сохраняться и восстанавливаться значения регистров процессора.

Есть такие два понятия идентификатор и дескриптор, то что их путают, значит ничего не сказать.

Идентификатор это просто число, которое позволяет идентифицировать процесс и обращаться к нему. Нескольких процессов с одинаковыми идентификаторами в один момент времени в системе не может быть.

Дескриптор это более сложная структура данных, которая хранит информацию об процессе и позволяет им управлять. Сложность дескриптора зависит от степени извращения разработчика ОС, в результате бывают дескрипторы попроще в виде одной структуры, а бывают и сложнее с кучей вложенных подструктур. (да, информация о приоритете процессе хранится в нём).

---
#### Идентификатор и дескриптор

- Данные и состояние аппаратуры ЭВМ, которые необходимы для нормальной работы процесса.
- Контекст должен быть сохранён при освобождении процессора (переходе в состояние готовности, либо блокировки) и восстановлен при возвращении в состояние выполнения. Как минимум, должны сохраняться и восстанавливаться значения регистров процессора.

*Идентификатор процесса* - некий объект, позволяющий понять, что перед нами конкретный процесс. Каждый процесс должен уникально однозначно идентифицироваться.

- Номер идентификатора может освобождаться для переназначения только после полного завершения процесса

**Дескриптор** - сложная структура данных, которая описывает процесс в системе. Содержит массу информации о конкретном выполняемом процессе.

![[ОС2.6.png]]

#### Демон (Daemon)

- Процесс, который после запуска сам разрывает связь со своим родительским процессом и становится независимым.
- Управление таким процессом со стороны ОС возможно только с помощью механизма ОС посылки сигналов (в ОС UNIX это команда kill).
- Демоны полезны для реализации постоянно действующих служб.

---
#### Потоки

- Само понятие потока появилось значительно позже понятия процесса.
- Обычно процесс может делиться на несколько потоков.
- Все потоки процесса разделяют выделенные ему ресурсы (сами процессы между собой, как правило, ресурсы не разделяют).
- Переключение между потоками внутри процесса значительно быстрее, чем между разными процессами.
- Обычно считается, что ОС все ресурсы, кроме времени процессора, распределяет между процессами, в то время как процессорное время ОС делит между потоками.

**Контекст процесса** - окружение, в котором он выполняется. Если мы процесс приостанавливаем, необходимо сохранить его контекст, чтобы при продолжении работы мы могли восстановить его состояние для продолжения работы. Как минимум, забирая процесс мы должны сохранить его регистр.

*Стоит учесть, что:*

- Процесс мог задействовать в контексте совершенно неожиданные вещи (процессы, работающие в одном окружении рабочего стола могут задействовать один и тот же графический рабочий стол для взаимодействия как с сервисом).
- Если взять ОС MS DOS и рассмотреть попытку запустить на ней в параллели несколько процессов. Если процессы функционируют в рамках текстового терминала, то большой проблемы быть не может, но каждый процесс выводит в терминал свои данные, которые могут вытеснять друг друга.

---

Next door: [[ОС - Лекция 3]]

