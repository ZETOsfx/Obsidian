#### Управление памятью

#ram

Методы управления оперативной памятью (физической)  - *1-я часть*
Виртуальная память и методы управления с ее помощью  - *2-я часть*

---
#### Общее

**Память (причем организована может быть по-разному):**

- Внешняя
- Оперативная
- Кэш-память

![[ОС6.1.png | 300]]

Память представляет собой некоторое устройство. В ней присутствуют пронумерованные ячейки, которые она предоставляет программам и процессам.

**Встает вопрос:** возможно ли выделять такую память только по запросу, или же дать возможность распределения память с упреждением?
- Можно ли удалять из памяти те или иные фрагменты в определенные моменты времени для предоставления памяти другой программе в случае нехватки?

**Управление памятью** – это процесс управления и координации памяти компьютера, назначение частей, известных как блоки, различным запущенным программам для оптимизации общей производительности системы.

Это самая важная функция операционной системы, которая управляет основной памятью. Это помогает процессам перемещаться вперед и назад между основной памятью и исполнительным диском. Это помогает ОС отслеживать каждую область памяти, независимо от того, выделена она для какого-либо процесса или остается свободной.

*Причины использования управления памятью:*
- Это позволяет вам проверить, сколько памяти должно быть выделено процессам, которые решают, какой процессор должен получить память в какое время.
- Отслеживает всякий раз, когда инвентарь становится свободным или нераспределенным. По нему будет обновляться статус.
- Он выделяет пространство для подпрограмм приложения.
- Также убедитесь, что эти приложения не мешают друг другу.
- Помогает защитить разные процессы друг от друга
- Он помещает программы в память, чтобы память использовалась в полной мере.

*Стратегии управления памятью:*
- Стратегия вталкивания ()
- Стратегия размещения (выделение памяти по запросу/упреждению)
- Стратегия выталкивания (откуда и куда и кого можно вытолкнуть)

*Самый простой способ распределения:* предоставлять программе определенный участок памяти по запросу с получением двух параметров (начало, длина).

*Выработанные человечеством методы управления оперативной памятью:*

- **Одно смежное распределение** 
	В MS DOS оперативная память разбивается на несколько частей, в самом начале операционная система записывает себя, а всю остальную часть отдаёт пользователю.

- **Разделенное Распределение**
	Он делит первичную память на различные разделы памяти, которые в основном являются смежными областями памяти. Каждый раздел хранит всю информацию для конкретной задачи или работы. Этот метод состоит из выделения раздела для задания при его запуске и нераспределения при его завершении.

- **Управление постраничной памятью**
	Этот метод делит основную память компьютера на блоки фиксированного размера, известные как фреймы страниц.
	Этот аппаратный блок управления памятью отображает страницы в кадры, которые должны быть распределены на основе страниц.

- **Управление сегментированной памятью**
	*Сегментированная память* – единственный метод управления памятью, который не предоставляет программе пользователя линейное и непрерывное адресное пространство.
	Сегменты нуждаются в аппаратной поддержке в виде таблицы сегментов. Он содержит физический адрес раздела в памяти, размер и другие данные, такие как биты защиты доступа и статус.

---
#### Методы управления оперативной памятью 

1. В свободную оперативную память поступают процессы, требующие выполнения. Операционная система нарезает процессы и распределяет их по оперативной памяти.

2. После частичного выполнения процессов в оперативной памяти появляются "дыры", которые заполняются ОС-й новыми процессами из очереди.

	Поскольку **дыра** - определенный фрагмент, выделить его как непрерывный участок памяти нельзя. При объединении нескольких "дыр" можно получить продолжительный участок памяти, возможный под резервирование более емкими процессами из очереди.
	
	![[ОС6.2.jpeg | 300]]
	
	*Здесь есть 2 нюанса:*
	
	- **Если дыры слишком маленькие** (что с ними делать?)
		- V1: пусть будут
		- V2: они создают проблемы с ОП (ОС будет дополнительно тратить ресурсы для них) - мы задаемся минимальным размером, меньше которого дыру создать нельзя / либо же уплотнение памяти - сдвиг все процессы сдвигаются к началу или концу (перемещающий загрузчик)
	
	- *Метод определения "дыры" для нового процесса*:
		- **Метод первого подходящего** (все дыры лежат в списке, первая подходящая по списку выбирается для нового процесса. требует минимум затрат от процессора)
		- **Метод следующего подходящего** (поиск первого подходящего с фиксацией метки, возобновляя поиск от метки, а не от начала оперативной памяти) - в среднем наиболее оптимальный
		- **Метод наилучшего подходящего** (предполагает поиск оптимального размера дыры для конкретного процесса - но требует затрат для поиска такой дыры)
		- **Метод наихудшего подходящего** (обратный подход - отрезая от большой дыры оставшуюся часть мы получаем большую дыру, в которую чаще всего еще можно что-то разместить)

3. Управление освобождающимися участками памяти

	*Методы управления:*
	- **Связный список** (упорядочивание по возрастанию адресов памяти - позволяет проверять, не являются ли соседние элементы смежными)
	  
	  ![[ОС6.3.jpeg | 300]]
	- **Метод Дональда ~~Трампа~~ Кнута** (метод этикеток) - каждый блок и дыра имеют в начале и в конце "этикетки" с данными о размере блока и адресе начала блока. Смежность блоков определяется по памяти методом обращения "к заднему байту" - получаем этикетку предыдущего (или некст) блока.
	
	  ![[ОС6.4.jpeg | 200]] ![[ОС6.5.jpeg | 200]]
	   
	  А че, а если свободен? Заглядываем на блок вперед и видим его загруженность. Если соседние блоки свободны - исключаем из списка второй блок и переносим его этикетку в конец, обновляя информацию о размере блока.
	
	- **Метод двойников** (нет никаких указателей, всю оперативную память делим на половины).

---

Все. Это шоу закончилось. Ласт лекция подошла к концу.
Занавес.

