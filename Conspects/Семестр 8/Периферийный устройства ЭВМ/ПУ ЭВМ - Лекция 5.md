*"... а я подумал так а в итоге и не так и не по-другому получится ..."* (С) Ефремыч

COM-порт, RS232, RS422, RS485, LPT

**COM-порт (последовательный порт)** - один из давних портов, первоначально использовался для сопряжения с модемом и подключения устройств (клавиатура + мышь).

![[e15.jpg]]

Кодирование сигналов: 5-8 бит
Напряжение: +-3 ~ +-25 В
16 сигналов 
Режим работы (sync / async). 
Разъём:
- первоначально: 
	- DB25p для терминала
	- DB25s для остальных устройств
- на данный момент:
	- DE9p для терминала
	- DE9s для остальных устройств

---
**Пины DE9**:

| 1   | CD  |
| --- | --- |
| 2   | RxD |
| 3   | TxD |
| 4   | DTR |
| 5   | SG  |
| 6   | DSR |
| 7   | RTS |
| 8   | CTS |
| 9   | RI  |
*Выходные из ПК:*
- **DTR** (Data Terminal Ready) - терминал (ПК) включен / готов к обмену
- **RTS** (Request To Send) - запрос на передачу
- **TxD** (Transmitted data) - передаваемые данные

*Входные:*
- **DSR** (Data Set Ready) - готовность ПУ к обмену
- **CTS** (Clear To Send) - очищен для передачи (готов принять)
- **RxD** (Resieved data) - принимаемые данные
- **SQ** (Signal ground) - сигнал "земля"
- **CD** (Cable Detect) - сообщает ПК, что модем видит несущую
- **RI** (Ring indicator) 

![[e14.jpg]]

![[e16.jpg | 400]]![[e17.jpg | 300]]

2 способа управления передачей по RS232:
- Аппаратное управление:
	1. ПК выставляет RTS (запрос)
	2. Ждет от ВУ (CTS от ВУ)
	3. ВУ выставляет CTS
	4. ПК выполняет передачу байта
- Программное управление
	1. Передача по TxD бит данных и прием по линии RxD управляющих сигналов
	2. Если внешнее устройство не успевает, оно отправляет 0xB XOFF (приостановить передачу)
	3. Если устройство догнало, отправка 0x11 XON (возобновить передачу)

Для взаимодействия используются 2 32-разрядных регистра:
1. Регистр данных 
2. Регистр команд (регистр управления)

![[e18.jpg]]

![[e19.jpg | 350]]![[e20.jpg | 350]]

![[e21.jpg]]

---

Next door: [[ПУ ЭВМ - Лекция 6]]
